채팅 시스템 설계
=

채팅 서비스의 클라이언트는 모바일 앱 또는 웹 어플리케이션이다.
클라이언트는 직접 소통하지 않고, 채팅 서비스와 통신한다.

채팅 서비스의 기본적인 기능은 아래와 같다.

1. 클라이언트로부터 메시지 수신
2. 메시지 수신자 결정 및 전달
3. 수신자가 접속 상태가 아니라면 접속할 때까지 해당 메시지 보관

폴링
-
폴링은 클라이언트가 주기적으로 서버에게 새 메시지가 있느냐고 물어보는 방법이다.
이때, 답해줄 메시지가 없다면 서버의 자원이 불필요하게 낭비된다는 문제가 있다.

롱 폴링
-
롱 폴링의 클라이언트는 새메시지가 반환되거나 타임아웃 될 때까지 연결을 유지한다.
클라이언트는 새메시지를 받으면 연결을 종료하고, 서버에 새로운 요청을 보내어 과정을 반복한다.

웹소켓
-
웹소켓은 서버가 클라이언트에 비동기 메시지를 보낼 때 가장 널리 사용하는 기술이다.
웹소켓 연결은 처음에는 HTTP이지만 특정 핸드셰이크 절차를 거쳐 웹소켓으로 업그레이드 된다.

무상태 서비스
-
무상태 서비스 로드밸런서 뒤에 위치하며, 전통적인 요청/응답 서비스이다.

상태유지 서비스
-
채팅 서버에서 클라이언트는 서버와 독립적인 네트워크 연결을 유지해야 하기 때문에 상태유지가 필요하다.

제 3자 서비스 연동
-

저장소
-
일반적인 데이터는 RDB에 저장한다.
하지만 채팅 이력은 키-값 저장소와 같은 NoSQL에 저장하는 것이 좋다.



